<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="François Leroy">

<title>Practical Class 6: Biodiversity changes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="practical_week_6_files/libs/clipboard/clipboard.min.js"></script>
<script src="practical_week_6_files/libs/quarto-html/quarto.js"></script>
<script src="practical_week_6_files/libs/quarto-html/popper.min.js"></script>
<script src="practical_week_6_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="practical_week_6_files/libs/quarto-html/anchor.min.js"></script>
<link href="practical_week_6_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="practical_week_6_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="practical_week_6_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="practical_week_6_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="practical_week_6_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#assessing-temporal-change-of-diversity" id="toc-assessing-temporal-change-of-diversity" class="nav-link active" data-scroll-target="#assessing-temporal-change-of-diversity">Assessing temporal change of diversity</a></li>
  <li><a href="#temporal-changes-of-species-richness" id="toc-temporal-changes-of-species-richness" class="nav-link" data-scroll-target="#temporal-changes-of-species-richness">Temporal changes of species richness</a>
  <ul class="collapse">
  <li><a href="#using-simple-linear-regression" id="toc-using-simple-linear-regression" class="nav-link" data-scroll-target="#using-simple-linear-regression">Using simple linear regression</a></li>
  <li><a href="#using-polynomial-regression" id="toc-using-polynomial-regression" class="nav-link" data-scroll-target="#using-polynomial-regression">Using polynomial regression</a></li>
  </ul></li>
  <li><a href="#assessing-colonization-extinction-and-persistence" id="toc-assessing-colonization-extinction-and-persistence" class="nav-link" data-scroll-target="#assessing-colonization-extinction-and-persistence">Assessing colonization, extinction and persistence</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Practical Class 6: Biodiversity changes</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>François Leroy </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<p><strong>Content of the workshop of today</strong></p>
<p>We will continue to work with the North American BBS that we worked with already. Last week, we assessed several metrics of biodiversity for the year 2019. However, we can wonder: how has bird biodiversity changed through time (<em>e.g.</em> from 1980 to 2021)?</p>
<p>To answer this question, we need <strong>time-series</strong> <em>i.e.</em>, data which have been harvested for several years at the same location. This is the case of the BBS: each road has been visited once a year for a very long time. Today, we will work with data from 1990 to 2021 and assess how had biodiversity changed through this period for the different BBS roads.</p>
<p>Also, when working with time-series, one thing to consider is how the repeated samples have been made through the years. Were they sampled for the same amount of time? By the same number of volunteers…? This is what is often called in ecology the <em>sampling effort</em> or the <em>study design</em>. Fortunately, the BBS data collection is standardized, which means that the volunteers have to follow a protocol when counting the birds. Thus, we can compare the data through time without having to account for the sampling effort.</p>
<section id="assessing-temporal-change-of-diversity" class="level1">
<h1>Assessing temporal change of diversity</h1>
<p>There are two ways to assess changes of biodiversity:</p>
<ol type="1">
<li><p>We can simply measure biodiversity (for instance with species richness) and then see how this metric has changed through time. This is called a <strong>temporal trend</strong>.</p></li>
<li><p>We can use metrics which are representing temporal dynamic of biodiversity. Here, we will study the three metrics responsible of the change of species richness: <em>colonization</em>, <em>extinction</em> and <em>persistence</em>.</p></li>
</ol>
</section>
<section id="temporal-changes-of-species-richness" class="level1">
<h1>Temporal changes of species richness</h1>
<section id="using-simple-linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="using-simple-linear-regression">Using simple linear regression</h2>
<p>We will first see how species richness has changed through time for the different BBS roads.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="do">## A bit of data management. This is the same as we did last week. </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Get the file names</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>file_list <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="st">"data/50-StopData/1997ToPresent_SurveyWide/"</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">full.names =</span> T)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Create the dataframe that will contain the data</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>species <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Loop over each file</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(file_list)){</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Load the file and temporary store it</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(file_list[i])</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Bind to the species dataframe</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  species <span class="ot">&lt;-</span> <span class="fu">rbind</span>(species, d)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Remove the temporary data</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(d)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Also, we will keep only the roads which have data in both 2000 and 2021</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>species <span class="ot">&lt;-</span> </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  species <span class="sc">%&gt;%</span> </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CountryNum, StateNum, Route) <span class="sc">%&gt;%</span> </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">any</span>(Year <span class="sc">==</span> <span class="dv">2000</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">any</span>(Year <span class="sc">==</span> <span class="dv">2021</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2000</span><span class="sc">:</span><span class="dv">2021</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Unlike last week, today we will work on the entire dataset, and not only year 2019.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Let's compute species richness for each road and each year using the RouteDataID column.</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>species_richness <span class="ot">&lt;-</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  species <span class="sc">%&gt;%</span> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RouteDataID) <span class="sc">%&gt;%</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">sr =</span> <span class="fu">length</span>(<span class="fu">unique</span>(AOU)),        <span class="do">## Compute species richness</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">CountryNum =</span> <span class="fu">unique</span>(CountryNum), <span class="do">## Keep the route info</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">StateNum =</span> <span class="fu">unique</span>(StateNum),     <span class="do">## Keep the route info</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">Route =</span> <span class="fu">unique</span>(Route),           <span class="do">## Keep the route info</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">Year =</span> <span class="fu">unique</span>(Year))             <span class="do">## Keep the year</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(species_richness)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 x 6
  RouteDataID    sr CountryNum StateNum Route  Year
        &lt;dbl&gt; &lt;int&gt;      &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt; &lt;dbl&gt;
1     6165782    50        840 34       036    2003
2     6165783    57        840 34       038    2003
3     6165784    66        840 34       039    2003
4     6165785    69        840 34       040    2003
5     6165786    48        840 34       044    2003
6     6165787    38        840 34       042    2003</code></pre>
</div>
</div>
<p>Let’s represent the values of species richness through time for a single route. It is important to note that the unique identifier of a road is composed by the combination of the three columns: <code>CountryNum + StateNum + Route</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Let's pick up randomly one road ####</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>species_richness <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CountryNum <span class="sc">==</span> <span class="dv">840</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>         StateNum <span class="sc">==</span> <span class="st">"35"</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>         Route <span class="sc">==</span> <span class="st">"005"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">#### and plot the value of species richness against time</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> sr))<span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)<span class="sc">+</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="practical_week_6_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Well, it seems like there is a linear relationship between species richness and time isn’t it? If you remember the class of last week, you know that we can fit a simple linear regression to explain how species richness is <em>“driven”</em> by the time (in other words how it behaves through time):</p>
<p><span class="math display">\[SR = \beta_1t + \beta_0\]</span></p>
<p><strong>Try to explain how</strong> <span class="math inline">\(\beta_1\)</span> <strong>and</strong> <span class="math inline">\(\beta_0\)</span> <strong>link the species richness with time</strong></p>
<p>Hereafter, we will fit simple linear regressions of species richness as a function of time for each road of the BBS.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Now let's fit a linear regression between species richness and time for each road. We could use a for loop but R as a cool function: do()</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>sr_trend <span class="ot">&lt;-</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  species_richness <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CountryNum, StateNum, Route) <span class="sc">%&gt;%</span>  <span class="do">## those 3 columns represent the route id</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do</span>({</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>      mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(sr <span class="sc">~</span> Year, <span class="at">data =</span> .)                               <span class="do">#### fit the linear model </span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data.frame</span>(<span class="at">slope =</span> <span class="fu">coef</span>(mod)[<span class="dv">2</span>],                             <span class="do">#### extract the slope</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">intercept =</span> <span class="fu">coef</span>(mod)[<span class="dv">1</span>],                         <span class="do">#### extract the intercept</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">pval =</span> (<span class="fu">summary</span>(mod)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="st">"Pr(&gt;|t|)"</span>])) <span class="do">#### extract the p-value</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># We can display the distribution of the slope values using</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sr_trend<span class="sc">$</span>slope)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="practical_week_6_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>What can we say about the trends of species richness from 2000 to 2021 for the BBS roads?</strong></p>
<p><strong>Using the script of last week, display on a map the BBS roads with the color indicating the temporal trend of species richness (exemple below)</strong> <em>Hint:</em> in order to set the color gradient from red to blue passing by white, you should use the function <code>scale_color_gradient2()</code>. Use <code>?scale_color_gradient2()</code> to know more.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="practical_week_6_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="using-polynomial-regression" class="level2">
<h2 class="anchored" data-anchor-id="using-polynomial-regression">Using polynomial regression</h2>
<p>Polynomial regression is a specific case of a linear regression. Even though the final function is not linear, the coefficients of each order of <span class="math inline">\(x\)</span> are linear:</p>
<p><span class="math display">\[y = \beta_1x_1 + \beta_2x_1^2 + \beta_3x_1^3 \ldots \beta _nx_1^n + \beta_0\]</span></p>
<p>Let’s use a time series of another random road:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>species_richness <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CountryNum <span class="sc">==</span> <span class="dv">840</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>         StateNum <span class="sc">==</span> <span class="st">"25"</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>         Route <span class="sc">==</span> <span class="st">"025"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">#### and plot the value of species richness against time</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> sr))<span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_smooth(method = "lm")+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="practical_week_6_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As you can see, this time the relationship does not really seem linear. So let’s fit polynomial regressions (<em>i.e.</em> quadratic, cubic…) and see how the regressions look like.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>poly_data <span class="ot">&lt;-</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  species_richness <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CountryNum <span class="sc">==</span> <span class="dv">840</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>         StateNum <span class="sc">==</span> <span class="st">"25"</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>         Route <span class="sc">==</span> <span class="st">"025"</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>poly_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(sr <span class="sc">~</span> <span class="fu">poly</span>(Year, <span class="dv">1</span>), <span class="at">data =</span> poly_data)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>poly_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(sr <span class="sc">~</span> <span class="fu">poly</span>(Year, <span class="dv">2</span>), <span class="at">data =</span> poly_data)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>poly_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(sr <span class="sc">~</span> <span class="fu">poly</span>(Year, <span class="dv">3</span>), <span class="at">data =</span> poly_data)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>poly_4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(sr <span class="sc">~</span> <span class="fu">poly</span>(Year, <span class="dv">4</span>), <span class="at">data =</span> poly_data)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> poly_data<span class="sc">$</span>Year, <span class="at">y =</span> poly_1<span class="sc">$</span>fitted.values, <span class="at">color =</span> <span class="st">"poly_1"</span>))<span class="sc">+</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> poly_data<span class="sc">$</span>Year, <span class="at">y =</span> poly_2<span class="sc">$</span>fitted.values, <span class="at">color =</span> <span class="st">"poly_2"</span>))<span class="sc">+</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> poly_data<span class="sc">$</span>Year, <span class="at">y =</span> poly_3<span class="sc">$</span>fitted.values, <span class="at">color =</span> <span class="st">"poly_3"</span>))<span class="sc">+</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> poly_data<span class="sc">$</span>Year, <span class="at">y =</span> poly_4<span class="sc">$</span>fitted.values, <span class="at">color =</span> <span class="st">"poly_4"</span>))<span class="sc">+</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> sr), <span class="at">data =</span> poly_data)<span class="sc">+</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="practical_week_6_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>You can see that the higher the order of the polynomial, the higher the flexibility of the model.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "R² poly1 = 0.152154474989737"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "R² poly2 = 0.350569287307634"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "R² poly3 = 0.707473782067586"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "R² poly4 = 0.702284540611484"</code></pre>
</div>
</div>
</section>
</section>
<section id="assessing-colonization-extinction-and-persistence" class="level1">
<h1>Assessing colonization, extinction and persistence</h1>
<div class="cell">

</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>